(this["webpackJsonpwork-time-scheduler"]=this["webpackJsonpwork-time-scheduler"]||[]).push([[0],{272:function(e,t,n){},277:function(e,t,n){},348:function(e,t,n){},349:function(e,t,n){},350:function(e,t,n){},419:function(e,t,n){},423:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(22),r=n.n(o),s=(n.p,n(272),n(40)),c=n(32),d=n(82),u=n(83),l=n(88),p=n(87),h=n(473),b=n(38),m=n(50),f=n(105),j=n(78),O=n(481),v=n(478),y=n(480),g=n(482),x=n(190),S=n(255),w=n(484),k=n(86),D="ADD_APPOINTMENTS",T="UPDATED_APPOINTMENT",A="DELETE_APPOINTMENT",C="ADD_JOB",E="UPDATE_JOB",P="DELETE_JOB",M=function(e){return{type:D,payload:e}},N=n(10),F=n.n(N),V=(n(277),"APPOINTMENT_STATE_TO_DO"),I="APPOINTMENT_STATE_COMPLETED",R="APPOINTMENT_STATE_CURRENT",_="APPOINTMENT_STATE_LATE",J="APPOINTMENT_STATE_DELAY",B="SCHEDULE_WORK_ONLY",H="SCHEDULE_FREE_TIME",U="SCHEDULE_FULL",Y="JOB_NOT_STARTED",L=n(485),W=n(486),q=n(483);function z(e,t,n,i,a){var o=Object(f.a)(i,2),r=o[0],c=o[1],d=Object(f.a)(a,2),u=d[0],l=d[1],p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,h=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(r&&c){console.log("continuosPeriodPriorization",h);var b=G(K(r,c,t,n,e,p,h),e),m=Q(b);if(0!=b.length&&m>=e)return{state:B,periods:b};if(u&&l){var j=e-m,O=G(K(u,l,t,n,j,p,h),j),v=Q(O),y=$([].concat(Object(s.a)(b),Object(s.a)(O)));return 0!=O.length&&m+v>=e?{state:H,periods:y}:{state:U,periods:y}}console.error("It was nescessary to use free time, but there was no free period start or end configured!")}else console.error("There was no work period start or end configured!")}function K(e,t,n,i,a,o){for(var r=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=[],c=o?o.clone():F()().add(1,"day").startOf("day").set("hour",e),d=t>e?c.clone().set("hour",t):c.clone().add(1,"day").set("hour",t),u=c.clone().set("hour",e),l={start:null,end:null,hours:0};c.isSameOrBefore(n);){if(!r&&0!=a)if(l.start){if(Q([].concat(s,[{hours:1+l.hours}]))>=a){l.end=c.clone(),l.hours++,s.push(Object.assign({},l)),l={start:null,end:null,hours:0};break}}else if(Q(s)>=a)break;var p=i.find((function(e){return!!c.isBetween(e.startDate,e.endDate,void 0,"[)")}));if(p)l.start&&(l.end=c.clone(),l.hours++,s.push(Object.assign({},l)),l={start:null,end:null,hours:0}),p.endDate.isSameOrAfter(d)?(d=d.add(1,"day"),u=u.add(1,"day"),c=u.clone()):c=c.set("hour",p.endDate.get("hour"));else{if(c.isSameOrAfter(n)){l.start&&(l.end=c.clone(),l.hours++,s.push(Object.assign({},l)));break}c.isSameOrAfter(d)?(l.start&&(l.end=c.clone(),l.hours++,s.push(Object.assign({},l)),l={start:null,end:null,hours:0}),d=d.add(1,"day"),u=u.add(1,"day"),c=u.clone()):(l.start?(l.end=c.clone(),l.hours++):l.start=c.clone(),c=c.add(1,"hour"))}}return s}function $(e){var t=[],n=[];return e.forEach((function(i,a){if(!n.includes(a)){var o=e.findIndex((function(e){return i.end.isSame(e.start)}));-1!==o&&(n.push(o),i.end=e[o].end,i.hours=i.end.diff(i.start,"hours")),t.push(i)}})),t}function G(e,t){if(Q(e)<=t)return e;e.sort((function(e,t){return e.hours>t.hours?-1:t.hours>e.hours?1:e.start.isBefore(t.start)?-1:e.start.isBefore(t.start)?1:0}));for(var n=t,i=[],a=0;a<e.length;a++){var o=e[a];if(o===n){i.push(o);break}if(o.hours>n){var r=o.hours-n;o.hours=o.hours-r,o.end=o.end.subtract(r,"hours"),i.push(o);break}i.push(o),n-=o.hours}return i}function Q(e){return e.reduce((function(e,t){return{hours:e.hours+t.hours}}),{hours:0}).hours}function X(e,t){var n=e.start,i=e.end,a=e.hours;return{startDate:n,endDate:i,state:V,hours:a,id:"job_"+t+"_app_"+Object(q.a)(),jobId:t}}var Z=n(13),ee={labelCol:{span:8},wrapperCol:{span:16}},te=function(e){Object(l.a)(n,e);var t=Object(p.a)(n);function n(e){var i;return Object(d.a)(this,n),(i=t.call(this,e)).formRef=a.a.createRef(),i.state={isModalVisible:!1,isFutherActionModalVisible:!1,appointmentPreview:null,appointmentPeriods:[],appointmentSuccessful:!1},i}return Object(u.a)(n,[{key:"resetFormState",value:function(){this.setState({isModalVisible:!1,isFutherActionModalVisible:!1,appointmentPreview:null,appointmentPeriods:[],appointmentSuccessful:!1})}},{key:"onFormSubmit",value:function(e){var t=F()().format("x"),n=this.state.appointmentPeriods.map((function(e){return X(e,t)})),i={id:t,name:e.name,appointments:n.map((function(e){return e.id})),price:e.price,description:e.description,dueDate:e.dueDate.startOf("hour"),totalHours:e.hours,state:Y};this.props.addJob(i),this.props.addAppointments(n),this.resetFormState(),this.formRef.current.resetFields()}},{key:"previewPeriods",value:function(e,t){var n=Object(f.a)(e,1)[0],i=Object(f.a)(t,6),a=(i[0],i[1],i[2],i[3]),o=i[4],r=i[5],s=this.props,c=s.appointments,d=s.workStart,u=s.workEnd,l=s.freeStart,p=s.freeEnd;if(n.name.includes("hours")||n.name.includes("dueDate"))if(a.value&&o.value){var h=z(a.value,o.value.startOf("hour"),c,[d,u],[l,p],null,r.value);if(!h)return void console.error("Error on saving the periods");switch(h.state){case B:this.setState({appointmentPreview:"The job can be sucessfully distributed in the work period",appointmentPeriods:h.periods,appointmentSuccessful:!0});break;case H:this.setState({appointmentPreview:"The job will invade some of your free time period",appointmentPeriods:h.periods,appointmentSuccessful:!0});break;case U:this.setState({appointmentPreview:"The job could not be distributed into your work/free time, further action will be required on submit",appointmentPeriods:h.periods,appointmentSuccessful:!1})}}else this.setState({appointmentPreview:"",appointmentPeriods:[]})}},{key:"onFutherActionSet",value:function(e){var t=this,n=this.props,i=n.appointments,a=n.workStart,o=n.workEnd,r=n.freeStart,c=n.freeEnd,d=this.formRef.current.getFieldsValue(),u=d.dueDate,l=d.hours,p=d.continuousPeriod,h=K(e?Math.min(a,r):Math.max(o,c),e?Math.max(o,c):Math.min(a,r),e?u.set("year",9999).startOf("hour"):u.startOf("hour"),[].concat(Object(s.a)(i),Object(s.a)(this.state.appointmentPeriods)),l-Q(this.state.appointmentPeriods),e?u.startOf("hour"):F()().startOf("day").set("hour",Math.max(o,c)),p),b=$([].concat(Object(s.a)(h),Object(s.a)(this.state.appointmentPeriods)));this.setState({appointmentPeriods:b,appointmentSuccessful:!0,appointmentPreview:"",isModalVisible:!1,isFutherActionModalVisible:!1},(function(){return t.onFormSubmit(t.formRef.current.getFieldsValue())}))}},{key:"allowFormToBeSubmitted",value:function(){var e=this.props,t=e.workStart,n=e.workEnd,i=e.freeStart,a=e.freeEnd;return!!(t&&n&&i&&a)}},{key:"validateDueDate",value:function(e,t){return F()().isSameOrAfter(t)?Promise.reject("The due date needs to be after now!"):Promise.resolve()}},{key:"render",value:function(){var e=this,t=this.allowFormToBeSubmitted();return Object(Z.jsxs)(a.a.Fragment,{children:[Object(Z.jsx)(j.a,{type:"primary",onClick:function(){return e.setState({isModalVisible:!0})},children:"Add Event"}),Object(Z.jsx)(O.a,{title:"Add Event",visible:this.state.isModalVisible,okText:"Submit",onCancel:this.resetFormState.bind(this),onOk:function(){e.formRef.current.validateFields().then((function(t){e.state.appointmentSuccessful?e.onFormSubmit(t):e.setState({isFutherActionModalVisible:!0})})).catch((function(e){console.log("Validate Failed:",e)}))},okButtonProps:{disabled:!t},children:Object(Z.jsxs)(v.a,Object(c.a)(Object(c.a)({},ee),{},{ref:this.formRef,name:"eventForm",initialValues:{continuousPeriod:!0},onFinish:function(t){return e.onFormSubmit(t)},onFieldsChange:this.previewPeriods.bind(this),children:[Object(Z.jsx)(v.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"The event name is required"}],children:Object(Z.jsx)(y.a,{disabled:!t})}),Object(Z.jsx)(v.a.Item,{label:"Description",name:"description",children:Object(Z.jsx)(y.a.TextArea,{disabled:!t})}),Object(Z.jsx)(v.a.Item,{label:"Price",name:"price",children:Object(Z.jsx)(g.a,{formatter:function(e){return"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\$\s?|(,*)/g,"")},min:0,precision:2,disabled:!t})}),Object(Z.jsx)(v.a.Item,{label:"Estimated Hours",name:"hours",rules:[{required:!0,message:"The ETA is required to allow the scheduler to distribute time"}],disabled:!t,children:Object(Z.jsx)(g.a,{min:0})}),Object(Z.jsx)(v.a.Item,{label:"Due Date",name:"dueDate",rules:[{required:!0,message:"The dude date is required"},{validator:this.validateDueDate}],disabled:!t,children:Object(Z.jsx)(x.a,{format:"DD/MM/YYYY HH:00",showTime:!0})}),Object(Z.jsx)(S.a,{title:"Whether the Scheduler should focus on finding continuous periods or just distribute the event in the open periods avaliable",children:Object(Z.jsx)(v.a.Item,{label:"Continuous Priority",valuePropName:"checked",name:"continuousPeriod",children:Object(Z.jsx)(w.a,{})})}),Object(Z.jsx)("span",{className:"message",children:this.state.appointmentPreview}),t?null:Object(Z.jsx)("span",{className:"message",children:"Please set the work and free period before attemping to add events to your schedule"})]}))}),Object(Z.jsx)(O.a,{visible:this.state.isFutherActionModalVisible,footer:[Object(Z.jsx)(S.a,{title:"Delay",children:Object(Z.jsx)(j.a,{type:"primary",onClick:function(){return e.onFutherActionSet(!0)},icon:Object(Z.jsx)(L.a,{})})},"delay"),Object(Z.jsx)(S.a,{title:"Overwrite Sleep",children:Object(Z.jsx)(j.a,{type:"primary",onClick:function(){return e.onFutherActionSet(!1)},icon:Object(Z.jsx)(W.a,{})})},"overwrite_sleep"),Object(Z.jsx)(j.a,{onClick:function(){return e.setState({isFutherActionModalVisible:!1})},children:"Cancel"},"back")],children:Object(Z.jsx)("p",{children:"The appointment submitted can't be concluded during your work and free period, what should the scheduler do to allow for this job to be scheduled?"})})]})}}]),n}(a.a.Component),ne=Object(k.b)((function(e){return{workStart:e.period.workStart,workEnd:e.period.workEnd,freeStart:e.period.freeStart,freeEnd:e.period.freeEnd,appointments:e.appointment.appointments,jobs:e.appointment.jobs}}),(function(e){return{addAppointments:function(t){return e(M(t))},addJob:function(t){return e({type:C,payload:t})}}}))(te),ie=n(475),ae="SET_WORK_PERIOD",oe="SET_FREE_PERIOD",re="WORK_PERIOD",se="FREE_PERIOD",ce=(n(348),ie.a.RangePicker),de=function(e){Object(l.a)(n,e);var t=Object(p.a)(n);function n(e){var i;return Object(d.a)(this,n),(i=t.call(this,e)).formRef=a.a.createRef(),i.state={isModalVisible:!1},i}return Object(u.a)(n,[{key:"onFormSubmit",value:function(e){switch(this.props.periodType){case re:this.props.setWorkPeriod({start:e.periodRange[0].get("hours"),end:e.periodRange[1].get("hours")});break;case se:this.props.setFreePeriod({start:e.periodRange[0].get("hours"),end:e.periodRange[1].get("hours")})}this.setState({isModalVisible:!1})}},{key:"getPeriodLabel",value:function(e){switch(e){case se:return"Free";case re:return"Work"}}},{key:"render",value:function(){var e=this;return Object(Z.jsxs)("div",{children:[Object(Z.jsxs)(j.a,{onClick:function(){return e.setState({isModalVisible:!0})},children:[this.getPeriodLabel(this.props.periodType)," Period"]}),Object(Z.jsx)(O.a,{title:"".concat(this.getPeriodLabel(this.props.periodType)," Period"),visible:this.state.isModalVisible,okText:"Submit",onCancel:function(){return e.setState({isModalVisible:!1})},onOk:function(){e.formRef.current.validateFields().then((function(t){e.onFormSubmit(t)})).catch((function(e){console.log("Validate Failed:",e)}))},children:Object(Z.jsx)(v.a,{ref:this.formRef,name:"periodForm",initialValues:{periodRange:[F()().startOf("day").set("hours",this.props.start),F()().startOf("day").set("hours",this.props.end)],remember:!0},onFinish:function(t){return e.onFormSubmit(t)},children:Object(Z.jsx)(v.a.Item,{name:"periodRange",rules:[{required:!0,message:"The range of the period is required!"}],children:Object(Z.jsx)(ce,{format:"HH:00"})})})})]})}}]),n}(a.a.Component),ue=Object(k.b)((function(e,t){switch(t.periodType){case re:return{start:new Number(e.period.workStart),end:new Number(e.period.workEnd)};case se:return{start:e.period.freeStart,end:e.period.freeEnd};default:return{}}}),(function(e){return{setWorkPeriod:function(t){return e({type:ae,payload:t})},setFreePeriod:function(t){return e({type:oe,payload:t})}}}))(de),le=(n(349),function(e){Object(l.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(d.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"onFormSubmit",value:function(){}},{key:"render",value:function(){return Object(Z.jsxs)("header",{children:[Object(Z.jsx)("h2",{children:"Work Scheduler"}),Object(Z.jsxs)("div",{className:"button-group",children:[Object(Z.jsx)(ue,{periodType:re}),Object(Z.jsx)(ue,{periodType:se}),Object(Z.jsx)(ne,{})]})]})}}]),n}(a.a.Component)),pe=n(117),he=n(158),be=n(487),me=n(488),fe=n(489),je=n(490),Oe=(n(350),n(474)),ve=n(476),ye=n(477),ge=n(135),xe=n.n(ge),Se=n(183),we=n.n(Se),ke=function(e){Object(l.a)(n,e);var t=Object(p.a)(n);function n(e){var i;return Object(d.a)(this,n),(i=t.call(this,e)).state={currentDay:F()().startOf("week").toDate(),currentViewName:"Day",appointmentUpdateInterval:null,isRealocateModalVisible:!1,realocatedState:{state:"",periods:[],appointment:null,job:null},isAppointmentTooltipVisible:!1,appointmentTooltipMetadata:{target:null,data:{}},shouldShowSleepPeriod:!0,startDayViewHour:0,endDayViewHour:24},i.toggleVisibility=function(){i.setState({isAppointmentTooltipVisible:!i.state.isAppointmentTooltipVisible})},i.onAppointmentMetaChange=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:{},target:null},t=e.data,n=e.target;i.setState({appointmentTooltipMetadata:{data:t,target:n}})},i}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.onUpdateAppointmentsState()}},{key:"componentWillUnmount",value:function(){this.state.appointmentUpdateInterval&&(clearTimeout(this.state.appointmentUpdateInterval),this.setState({appointmentUpdateInterval:null}))}},{key:"onUpdateAppointmentsState",value:function(){var e=this;this.props.appointments.forEach((function(t){var n=e.checkStateOfAppointment(t);t.state!==n&&(console.log("New state"+n+"for appoitnment"+t.id),t.state=n,e.props.updateAppointment(t))}));var t=F()().add(1,"hour").startOf("hour").add(1,"second").diff(F()(),"milliseconds");this.setState({appointmentUpdateInterval:setTimeout((function(){return e.onUpdateAppointmentsState()}),t)})}},{key:"checkStateOfAppointment",value:function(e){if(e.state===I)return I;var t=this.findJobOfAppointment(e);return e.startDate.isAfter(t.dueDate)?J:e.endDate.isBefore(F()())?_:e.startDate.isAfter(F()())?V:R}},{key:"TableTimeCellRenderer",value:function(e){var t=this.props,n=t.workStart,i=t.workEnd,a=t.freeStart,o=t.freeEnd,r=F()(e.startDate),s=F()(e.endDate),d="sleep-period";return this.isHoursBetween(n,i,r,s)?d="work-period":this.isHoursBetween(a,o,r,s)&&(d="free-period"),Object(Z.jsx)(m.e.TimeTableCell,Object(c.a)(Object(c.a)({},e),{},{className:d}))}},{key:"isHoursBetween",value:function(e,t,n,i){var a=n.clone().startOf("day").set("hour",e),o=i.clone().startOf("day").set("hour",t);return n.isBetween(a,o,void 0,"[)")&&i.isBetween(a,o,void 0,"(]")}},{key:"getCustomAppointmentContent",value:function(e){var t=e.data,n=e.formatDate,i=this.findJobOfAppointment(t);return Object(Z.jsx)(m.b.AppointmentContent,Object(c.a)(Object(c.a)({},e),{},{style:{height:"100%"},children:Object(Z.jsxs)("div",{className:"app-appointment-content",children:[Object(Z.jsx)("div",{className:"title",children:i.name}),i.price?Object(Z.jsxs)("div",{className:"value-wrapper",children:["$ ",i.price.toFixed(2)]}):null,Object(Z.jsxs)("span",{children:["Due to: ",i.dueDate.format("DD/MM/YYYY HH:00")]}),Object(Z.jsxs)("div",{className:"hour-wrapper",children:[Object(Z.jsx)("span",{children:n(t.startDate,{hour:"numeric",minute:"numeric"})}),Object(Z.jsx)("span",{style:{padding:"0px 3px"},children:" - "}),Object(Z.jsx)("span",{children:n(t.endDate,{hour:"numeric",minute:"numeric"})})]})]})}))}},{key:"getTooltipContent",value:function(e){var t=this,n=e.appointmentData,i=e.formatDate,a=this.findJobOfAppointment(n);return a?Object(Z.jsxs)("div",{className:"tooltip-content",children:[Object(Z.jsxs)(Oe.a,{container:!0,alignItems:"flex-start",className:"meta",children:[Object(Z.jsx)(Oe.a,{item:!0,xs:2,style:{display:"flex",justifyContent:"center"},children:Object(Z.jsx)(ve.a,{className:"lens",style:{color:n.state===V?"#1890ff":n.state===I?"#a4b1db":n.state===R?"green":n.state===_?"orange":"crimson"}})}),Object(Z.jsxs)(Oe.a,{item:!0,xs:10,children:[Object(Z.jsx)("div",{className:"title",children:a.name}),Object(Z.jsx)("div",{children:n.startDate.format("dddd, DD MMMM YYYY")})]})]}),Object(Z.jsxs)(Oe.a,{container:!0,alignItems:"center",style:{marginTop:"10px"},children:[Object(Z.jsx)(Oe.a,{item:!0,xs:2,style:{display:"flex",justifyContent:"center",color:"gray"},children:Object(Z.jsx)(pe.a,{style:{fontSize:"24px"}})}),Object(Z.jsx)(Oe.a,{item:!0,xs:10,children:Object(Z.jsx)("div",{children:"".concat(i(n.startDate,{hour:"numeric",minute:"numeric"}),"\n                            - ").concat(i(n.endDate,{hour:"numeric",minute:"numeric"}))})})]}),Object(Z.jsxs)(Oe.a,{container:!0,alignItems:"center",children:[Object(Z.jsx)(Oe.a,{item:!0,xs:2,style:{display:"flex",justifyContent:"center",color:"gray"},children:Object(Z.jsx)(ye.a,{style:{fontSize:"24px"}})}),Object(Z.jsx)(Oe.a,{item:!0,xs:10,children:Object(Z.jsxs)("span",{children:["Due at ",a.dueDate.format("dddd, DD MMMM YYYY HH:00")]})})]}),a.description?Object(Z.jsx)("p",{className:"description",children:a.description}):null,Object(Z.jsxs)("div",{className:"tooltip-wrapper",children:[Object(Z.jsx)(j.a,{disabled:n.state===I,onClick:function(){return t.onCompleteTheAppointment(n)},icon:Object(Z.jsx)(he.a,{}),size:"large",children:"Complete"}),Object(Z.jsx)(j.a,{onClick:function(){return t.onDelayTheAppointment(n)},icon:Object(Z.jsx)(L.a,{}),size:"large",children:"Delay"}),Object(Z.jsx)(j.a,{onClick:function(){return t.onFinishTheAppointment(n)},icon:Object(Z.jsx)(be.a,{}),size:"large",children:"Finish"})]})]}):null}},{key:"onCompleteTheAppointment",value:function(e){var t=this.props,n=t.appointments,i=t.jobs,a=Object(s.a)(n),o=a.findIndex((function(t){return t.id===e.id}));if(-1!==o){a[o].state=I;var r=i.find((function(t){return t.id===e.jobId}));this.shouldDeleteJob(r,a)?(this.props.deleteJob(r),this.toggleVisibility(),this.onAppointmentMetaChange()):(this.props.updateAppointment(a[o]),this.props.updateJob(this.onUpdateJobStateOnAppointmentChange(r,a)))}else console.error("Unknown appointment was completed!")}},{key:"onUpdateJobStateOnAppointmentChange",value:function(e,t){var n=t.filter((function(t){return e.appointments.includes(t.id)}));return 0===n.filter((function(e){return e.state===V||e.state===R||e.state===J||e.state===_})).length?e.state="JOB_COMPLETED":0===n.filter((function(e){return e.state===I})).length?e.state=Y:e.state="JOB_ON_GOING",e}},{key:"shouldDeleteJob",value:function(e,t){return 0===t.filter((function(t){return e.appointments.includes(t.id)})).filter((function(e){return e.state===V||e.state===R||e.state===J||e.state===_})).length}},{key:"onDelayTheAppointment",value:function(e){var t=this.props,n=t.workStart,i=t.workEnd,a=t.freeStart,o=t.freeEnd,r=t.appointments,s=this.findJobOfAppointment(e),d=z(e.hours,s.dueDate,r,[n,i],[a,o],e.endDate);d.state===H||d===U?(this.setState({realocatedState:Object(c.a)(Object(c.a)({},d),{},{appointment:e,job:s}),isRealocateModalVisible:!0}),this.toggleVisibility(),this.onAppointmentMetaChange()):this.onConfirmationOfRealocation(Object(c.a)(Object(c.a)({},d),{},{appointment:e,job:s}))}},{key:"onConfirmationOfRealocation",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=t||this.state.realocatedState,i=n.periods,a=n.job,o=n.appointment,r=i.map((function(e){return X(e,a.id)})),c=a.appointments.findIndex((function(e){return e===o.id}));(e=a.appointments).splice.apply(e,[c,1].concat(Object(s.a)(r.map((function(e){return e.id}))))),this.props.updateJob(a),this.props.deleteAppointment([o.id]),this.props.addAppointments(r),this.setState({isRealocateModalVisible:!1,realocatedState:null})}},{key:"onFinishTheAppointment",value:function(e){var t=this.findJobOfAppointment(e);this.props.deleteJob(t),this.toggleVisibility(),this.onAppointmentMetaChange()}},{key:"getAppointmentComponet",value:function(e){var t,n=this,i=e.children,a=e.style,o=e.data;return o.state===I?t="appointment-done":o.state===R?t="appointment-active":o.state===_?t="appointment-late":o.state===J&&(t="appointment-delay"),Object(Z.jsx)(m.b.Appointment,Object(c.a)(Object(c.a)({},e),{},{className:t,style:Object(c.a)({},a),onClick:function(e){for(var t=e.target,i=e.data,a=t;"absolute"!==(a=a.parentElement).style.position;);n.onAppointmentMetaChange({target:a,data:i}),n.toggleVisibility()},children:i}))}},{key:"findJobOfAppointment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?this.props.jobs.findIndex((function(t){return t.id===e.jobId})):this.props.jobs.find((function(t){return t.id===e.jobId}))}},{key:"onAppointmentChangeCommited",value:function(e){var t=this,n=this.props.appointments;if(e.deleted){var i=n.find((function(t){return t.id===e.deleted})),a=this.findJobOfAppointment(i),o=Object(s.a)(n);o.splice(o.findIndex((function(t){return t.id===e.deleted})),1),this.shouldDeleteJob(a,o)?this.props.deleteJob(a):(a.appointments.splice(a.appointments.findIndex((function(t){return t===e.deleted})),1),this.props.deleteAppointment([e.deleted]),this.props.updateJob(a)),this.toggleVisibility(),this.onAppointmentMetaChange()}e.changed&&Object.keys(e.changed).forEach((function(i){var a=e.changed[i],o=a.endDate,r=a.startDate,s=n.find((function(e){return e.id===i})),c=F()(r),d=F()(o);24===d.diff(c,"hours")&&(c.set("hour",t.props.workStart),d=c.clone().set("hour",t.props.workStart+s.hours)),s.startDate=c,s.endDate=d,s.state=t.checkStateOfAppointment(s),t.props.updateAppointment(s)}))}},{key:"getToolbarFreeSpaceComponent",value:function(){var e=this;return Object(Z.jsx)(m.i.FlexibleSpace,{className:"toolbar-flexible-space",children:Object(Z.jsx)(we.a,{checked:this.state.shouldShowSleepPeriod,onChange:function(t){var n=e.props,i=n.workStart,a=n.workEnd,o=n.freeStart,r=n.freeEnd,s=t.target.checked;e.setState({shouldShowSleepPeriod:s,startDayViewHour:s?0:Math.min(i,o),endDayViewHour:s?24:Math.max(a,r)})},children:"Show Sleep Period"})})}},{key:"getViewSwitcherComponent",value:function(e){var t=this;return Object(Z.jsx)(m.j.Switcher,Object(c.a)(Object(c.a)({},e),{},{onChange:function(e){return t.setState({currentViewName:e})}}))}},{key:"getNavigatorRootComponent",value:function(e){return Object(Z.jsx)(m.d.Root,Object(c.a)({className:"date-navigator-root"},e))}},{key:"getDateNavigatorComponent",value:function(e){var t=this,n="forward"===e.type;return Object(Z.jsxs)("div",{className:"navigation-pair-button-wrapper ".concat(n?"":"reverse"),children:[Object(Z.jsx)("button",{onClick:function(){return t.onNaviagateDate(e.type)},children:n?Object(Z.jsx)(me.a,{}):Object(Z.jsx)(fe.a,{})}),"Day"===this.state.currentViewName?Object(Z.jsx)("button",{onClick:function(){return t.onNaviagateDate(e.type,!0)},children:"forward"===e.type?Object(Z.jsx)(be.a,{}):Object(Z.jsx)(je.a,{})}):null]})}},{key:"onNaviagateDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.state.currentDay;switch(this.state.currentViewName){case"Day":return void this.setState({currentDay:"forward"===e?F()(n).add(t?7:1,"day").toDate():F()(n).subtract(t?7:1,"day").toDate()});case"Month":return void this.setState({currentDay:"forward"===e?F()(n).add(1,"month").toDate():F()(n).subtract(1,"month").toDate()})}}},{key:"render",value:function(){var e=this;return Object(Z.jsxs)("div",{id:"home-wrapper",children:[Object(Z.jsx)(le,{}),Object(Z.jsx)(h.a,{children:Object(Z.jsxs)(m.h,{locale:"en-UK",data:this.props.appointments,children:[Object(Z.jsx)(b.s,{currentDate:this.state.currentDay,currentViewName:this.state.currentViewName}),Object(Z.jsx)(b.k,{onCommitChanges:this.onAppointmentChangeCommited.bind(this)}),Object(Z.jsx)(b.m,{}),Object(Z.jsx)(m.c,{}),Object(Z.jsx)(m.e,{displayName:"Week",cellDuration:60,intervalCount:7,startDayHour:this.state.startDayViewHour,endDayHour:this.state.endDayViewHour,timeTableCellComponent:this.TableTimeCellRenderer.bind(this)}),Object(Z.jsx)(m.g,{}),Object(Z.jsx)(m.i,{flexibleSpaceComponent:this.getToolbarFreeSpaceComponent.bind(this)}),Object(Z.jsx)(m.j,{switcherComponent:this.getViewSwitcherComponent.bind(this)}),Object(Z.jsx)(m.d,{rootComponent:this.getNavigatorRootComponent.bind(this),navigationButtonComponent:this.getDateNavigatorComponent.bind(this)}),Object(Z.jsx)(m.b,{appointmentComponent:this.getAppointmentComponet.bind(this),appointmentContentComponent:this.getCustomAppointmentContent.bind(this)}),Object(Z.jsx)(m.a,{showCloseButton:!0,showDeleteButton:!0,visible:this.state.isAppointmentTooltipVisible,appointmentMeta:this.state.appointmentTooltipMetadata,onAppointmentMetaChange:this.onAppointmentMetaChange,onVisibilityChange:function(){return e.setState({isAppointmentTooltipVisible:!1})},contentComponent:this.getTooltipContent.bind(this)}),Object(Z.jsx)(m.f,{allowResize:function(){return!1}})]})}),this.state.realocatedState?Object(Z.jsx)(xe.a,{visible:this.state.isRealocateModalVisible,onOk:function(){return e.onConfirmationOfRealocation()},onCancel:function(){return e.setState({isRealocateModalVisible:!1,realocatedState:null})},children:Object(Z.jsx)("p",{style:{marginTop:"20px"},children:this.state.realocatedState.state===H?"The appointment submitted can't be concluded during your work period,\n                                        do you want to allocate your free time for this appointment?":"The appointment submitted can't be concluded during your work or free time,\n                                        should the scheduler ignore your sleep period and allocate time in it?"})}):null]})}}]),n}(a.a.Component),De=Object(k.b)((function(e){return{workStart:e.period.workStart,workEnd:e.period.workEnd,freeStart:e.period.freeStart,freeEnd:e.period.freeEnd,appointments:e.appointment.appointments,jobs:e.appointment.jobs}}),(function(e){return{addAppointments:function(t){return e(M(t))},updateAppointment:function(t){return e({type:T,payload:t})},deleteAppointment:function(t){return e({type:A,payload:t})},updateJob:function(t){return e({type:E,payload:t})},deleteJob:function(t){return e({type:P,payload:t})}}}))(ke);var Te=function(){return Object(Z.jsx)(De,{})},Ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,492)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),i(e),a(e),o(e),r(e)}))},Ce=(n(418),n(419),n(71)),Ee=n(154),Pe=n(250),Me=n.n(Pe);function Ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=e.findIndex((function(e){return e.id===t.id}));if(-1===n)return console.error("The update operation on appointments failed, no appointment with id "+t.id+" found"),e;var i=Object(s.a)(e);return i[n]=t,i}function Fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=e.findIndex((function(e){return e.id===t.id}));if(-1===n)return console.error("The update operation on jobs failed, no job with id "+t.id+" found"),e;var i=Object(s.a)(e);return i[n]=t,i}function Ve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t.map((function(t){return e.findIndex((function(e){return e.id===t}))})),i=Object(s.a)(e);return n.forEach((function(e){return i.splice(e,1)})),i}function Ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=t.findIndex((function(t){return t.id===e.id})),a=Object(s.a)(t);a.splice(i,1);var o=Object(s.a)(n);return e.appointments.forEach((function(e){var t=o.findIndex((function(t){return t.id===e}));o.splice(t,1)})),{jobs:a,appointments:o}}var Re={appointments:[],jobs:[],history:[]},_e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return Object(c.a)(Object(c.a)({},e),{},{appointments:[].concat(Object(s.a)(e.appointments),Object(s.a)(t.payload))});case T:return Object(c.a)(Object(c.a)({},e),{},{appointments:Ne(e.appointments,t.payload)});case A:return Object(c.a)(Object(c.a)({},e),{},{appointments:Ve(e.appointments,t.payload)});case C:return Object(c.a)(Object(c.a)({},e),{},{jobs:[].concat(Object(s.a)(e.jobs),[t.payload])});case E:return Object(c.a)(Object(c.a)({},e),{},{jobs:Fe(e.jobs,t.payload)});case P:var n=Ie(t.payload,e.jobs,e.appointments),i=n.jobs,a=n.appointments;return Object(c.a)(Object(c.a)({},e),{},{jobs:i,appointments:a});default:return e}},Je=n(136),Be=function(e,t){return t instanceof F.a?t.toISOString():t},He=function(e,t){return"string"===typeof t&&t.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?F()(t):t},Ue={workStart:null,workEnd:null,freeStart:null,freeEnd:null},Ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae:return Object(c.a)(Object(c.a)({},e),{},{workStart:t.payload.start,workEnd:t.payload.end});case oe:return Object(c.a)(Object(c.a)({},e),{},{freeStart:t.payload.start,freeEnd:t.payload.end});default:return e}},Le={key:"root",storage:Me.a,transforms:[Object(Je.a)((function(e){return JSON.stringify(e,Be)}),(function(e){return JSON.parse(e,He)}))]},We=Object(Ce.c)({period:Ye,appointment:_e}),qe=Object(Ee.a)(Le,We);n(422);var ze=Object(Ce.d)(qe,Ce.a.apply(void 0,[])),Ke=Object(Ee.b)(ze),$e=n(251);r.a.render(Object(Z.jsx)(a.a.StrictMode,{children:Object(Z.jsx)(k.a,{store:ze,children:Object(Z.jsx)($e.a,{persistor:Ke,children:Object(Z.jsx)(Te,{})})})}),document.getElementById("root")),Ae()}},[[423,1,2]]]);
//# sourceMappingURL=main.eb39ef1d.chunk.js.map