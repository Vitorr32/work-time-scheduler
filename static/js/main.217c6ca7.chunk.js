(this["webpackJsonpwork-time-scheduler"]=this["webpackJsonpwork-time-scheduler"]||[]).push([[0],{274:function(e,t,n){},279:function(e,t,n){},350:function(e,t,n){},351:function(e,t,n){},352:function(e,t,n){},421:function(e,t,n){},425:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(22),r=n.n(o),s=(n.p,n(274),n(256)),c=n(38),u=n(30),d=n(82),l=n(83),p=n(88),h=n(87),m=n(476),b=n(39),f=n(47),j=n(106),O=n(78),v=n(485),y=n(482),g=n(484),x=n(486),S=n(191),k=n(257),w=n(488),D=n(86),A="ADD_APPOINTMENTS",T="UPDATED_APPOINTMENT",C="DELETE_APPOINTMENT",P="ADD_JOB",E="UPDATE_JOB",M="DELETE_JOB",V=function(e){return{type:A,payload:e}},N=n(10),F=n.n(N),I=(n(279),"APPOINTMENT_STATE_TO_DO"),R="APPOINTMENT_STATE_COMPLETED",_="APPOINTMENT_STATE_CURRENT",J="APPOINTMENT_STATE_LATE",H="APPOINTMENT_STATE_DELAY",B="SCHEDULE_WORK_ONLY",U="SCHEDULE_FREE_TIME",Y="SCHEDULE_FULL",L="JOB_NOT_STARTED",q=n(489),W=n(490),z=n(487);function K(e,t,n,i,a){var o=Object(j.a)(i,2),r=o[0],s=o[1],u=Object(j.a)(a,2),d=u[0],l=u[1],p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,h=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(r&&s){console.log("continuosPeriodPriorization",h);var m=X($(r,s,t,n,e,p,h),e),b=Q(m);if(0!=m.length&&b>=e)return{state:B,periods:m};if(d&&l){var f=e-b,O=X($(d,l,t,n,f,p,h),f),v=Q(O),y=G([].concat(Object(c.a)(m),Object(c.a)(O)));return 0!=O.length&&b+v>=e?{state:U,periods:y}:{state:Y,periods:y}}console.error("It was nescessary to use free time, but there was no free period start or end configured!")}else console.error("There was no work period start or end configured!")}function $(e,t,n,i,a,o){for(var r=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=[],u=o?o.clone():F()().add(1,"day").startOf("day").set("hour",e),d=t>e?u.clone().set("hour",t):u.clone().add(1,"day").set("hour",t),l=u.clone().set("hour",e),p={start:null,end:null,hours:0};u.isSameOrBefore(n);){if(0!==s&&p.start&&p.hours+1>=s&&(p.end=u.clone(),p.hours++,c.push(Object.assign({},p)),p={start:null,end:null,hours:0}),!r&&0!=a)if(p.start){if(Q([].concat(c,[{hours:1+p.hours}]))>=a){p.end=u.clone(),p.hours++,c.push(Object.assign({},p)),p={start:null,end:null,hours:0};break}}else if(Q(c)>=a)break;var h=i.find((function(e){return!!u.isBetween(e.startDate,e.endDate,void 0,"[)")}));if(h)p.start&&(p.end=u.clone(),p.hours++,c.push(Object.assign({},p)),p={start:null,end:null,hours:0}),h.endDate.isSameOrAfter(d)?(d=d.add(1,"day"),l=l.add(1,"day"),u=l.clone()):u=u.set("hour",h.endDate.get("hour"));else{if(u.isSameOrAfter(n)){p.start&&(p.end=u.clone(),p.hours++,c.push(Object.assign({},p)));break}u.isSameOrAfter(d)?(p.start&&(p.end=u.clone(),p.hours++,c.push(Object.assign({},p)),p={start:null,end:null,hours:0}),d=d.add(1,"day"),l=l.add(1,"day"),u=l.clone()):(p.start?(p.end=u.clone(),p.hours++):p.start=u.clone(),u=u.add(1,"hour"))}}return c}function G(e){var t=[],n=[];return e.forEach((function(i,a){if(!n.includes(a)){var o=e.findIndex((function(e){return i.end.isSame(e.start)}));-1!==o&&(n.push(o),i.end=e[o].end,i.hours=i.end.diff(i.start,"hours")),t.push(i)}})),t}function X(e,t){if(Q(e)<=t)return e;e.sort((function(e,t){return e.hours>t.hours?-1:t.hours>e.hours?1:e.start.isBefore(t.start)?-1:e.start.isBefore(t.start)?1:0}));for(var n=t,i=[],a=0;a<e.length;a++){var o=e[a];if(o===n){i.push(o);break}if(o.hours>n){var r=o.hours-n;o.hours=o.hours-r,o.end=o.end.subtract(r,"hours"),i.push(o);break}i.push(o),n-=o.hours}return i}function Q(e){return e.reduce((function(e,t){return{hours:e.hours+t.hours}}),{hours:0}).hours}function Z(e,t){var n=e.start,i=e.end,a=e.hours;return{startDate:n,endDate:i,state:I,hours:a,id:"job_"+t+"_app_"+Object(z.a)(),jobId:t}}var ee=n(13),te={labelCol:{span:8},wrapperCol:{span:16}},ne=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var i;return Object(d.a)(this,n),(i=t.call(this,e)).formRef=a.a.createRef(),i.state={isModalVisible:!1,isFutherActionModalVisible:!1,appointmentPreview:null,appointmentPeriods:[],appointmentSuccessful:!1},i}return Object(l.a)(n,[{key:"resetFormState",value:function(){this.setState({isModalVisible:!1,isFutherActionModalVisible:!1,appointmentPreview:null,appointmentPeriods:[],appointmentSuccessful:!1})}},{key:"onFormSubmit",value:function(e){var t=F()().format("x"),n=this.state.appointmentPeriods.map((function(e){return Z(e,t)})),i={id:t,name:e.name,appointments:n.map((function(e){return e.id})),price:e.price,description:e.description,dueDate:e.dueDate.startOf("hour"),totalHours:e.hours,state:L};this.props.addJob(i),this.props.addAppointments(n),this.resetFormState(),this.formRef.current.resetFields()}},{key:"previewPeriods",value:function(e,t){var n=Object(j.a)(e,1)[0],i=Object(j.a)(t,6),a=(i[0],i[1],i[2],i[3]),o=i[4],r=i[5],s=this.props,c=s.appointments,u=s.workStart,d=s.workEnd,l=s.freeStart,p=s.freeEnd;if(n.name.includes("hours")||n.name.includes("dueDate"))if(a.value&&o.value){var h=K(a.value,o.value.startOf("hour"),c,[u,d],[l,p],null,r.value);if(!h)return void console.error("Error on saving the periods");switch(h.state){case B:this.setState({appointmentPreview:"The job can be sucessfully distributed in the work period",appointmentPeriods:h.periods,appointmentSuccessful:!0});break;case U:this.setState({appointmentPreview:"The job will invade some of your free time period",appointmentPeriods:h.periods,appointmentSuccessful:!0});break;case Y:this.setState({appointmentPreview:"The job could not be distributed into your work/free time, further action will be required on submit",appointmentPeriods:h.periods,appointmentSuccessful:!1})}}else this.setState({appointmentPreview:"",appointmentPeriods:[]})}},{key:"onFutherActionSet",value:function(e){var t=this,n=this.props,i=n.appointments,a=n.workStart,o=n.workEnd,r=n.freeStart,s=n.freeEnd,u=this.formRef.current.getFieldsValue(),d=u.dueDate,l=u.hours,p=u.continuousPeriod,h=$(e?Math.min(a,r):Math.max(o,s),e?Math.max(o,s):Math.min(a,r),e?d.set("year",9999).startOf("hour"):d.startOf("hour"),[].concat(Object(c.a)(i),Object(c.a)(this.state.appointmentPeriods)),l-Q(this.state.appointmentPeriods),e?d.startOf("hour"):F()().startOf("day").set("hour",Math.max(o,s)),p),m=G([].concat(Object(c.a)(h),Object(c.a)(this.state.appointmentPeriods)));this.setState({appointmentPeriods:m,appointmentSuccessful:!0,appointmentPreview:"",isModalVisible:!1,isFutherActionModalVisible:!1},(function(){return t.onFormSubmit(t.formRef.current.getFieldsValue())}))}},{key:"allowFormToBeSubmitted",value:function(){var e=this.props,t=e.workStart,n=e.workEnd,i=e.freeStart,a=e.freeEnd;return!!(t&&n&&i&&a)}},{key:"validateDueDate",value:function(e,t){return F()().isSameOrAfter(t)?Promise.reject("The due date needs to be after now!"):Promise.resolve()}},{key:"render",value:function(){var e=this,t=this.allowFormToBeSubmitted();return Object(ee.jsxs)(a.a.Fragment,{children:[Object(ee.jsx)(O.a,{type:"primary",onClick:function(){return e.setState({isModalVisible:!0})},children:"Add Event"}),Object(ee.jsx)(v.a,{title:"Add Event",visible:this.state.isModalVisible,okText:"Submit",onCancel:this.resetFormState.bind(this),onOk:function(){e.formRef.current.validateFields().then((function(t){e.state.appointmentSuccessful?e.onFormSubmit(t):e.setState({isFutherActionModalVisible:!0})})).catch((function(e){console.log("Validate Failed:",e)}))},okButtonProps:{disabled:!t},children:Object(ee.jsxs)(y.a,Object(u.a)(Object(u.a)({},te),{},{ref:this.formRef,name:"eventForm",initialValues:{continuousPeriod:!0},onFinish:function(t){return e.onFormSubmit(t)},onFieldsChange:this.previewPeriods.bind(this),children:[Object(ee.jsx)(y.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"The event name is required"}],children:Object(ee.jsx)(g.a,{disabled:!t})}),Object(ee.jsx)(y.a.Item,{label:"Description",name:"description",children:Object(ee.jsx)(g.a.TextArea,{disabled:!t})}),Object(ee.jsx)(y.a.Item,{label:"Price",name:"price",children:Object(ee.jsx)(x.a,{formatter:function(e){return"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\$\s?|(,*)/g,"")},min:0,precision:2,disabled:!t})}),Object(ee.jsx)(y.a.Item,{label:"Estimated Hours",name:"hours",rules:[{required:!0,message:"The ETA is required to allow the scheduler to distribute time"}],disabled:!t,children:Object(ee.jsx)(x.a,{min:0})}),Object(ee.jsx)(y.a.Item,{label:"Due Date",name:"dueDate",rules:[{required:!0,message:"The dude date is required"},{validator:this.validateDueDate}],disabled:!t,children:Object(ee.jsx)(S.a,{format:"DD/MM/YYYY HH:00",showTime:!0})}),Object(ee.jsx)(k.a,{title:"Whether the Scheduler should focus on finding continuous periods or just distribute the event in the open periods avaliable",children:Object(ee.jsx)(y.a.Item,{label:"Continuous Priority",valuePropName:"checked",name:"continuousPeriod",children:Object(ee.jsx)(w.a,{})})}),Object(ee.jsx)("span",{className:"message",children:this.state.appointmentPreview}),t?null:Object(ee.jsx)("span",{className:"message",children:"Please set the work and free period before attemping to add events to your schedule"})]}))}),Object(ee.jsx)(v.a,{visible:this.state.isFutherActionModalVisible,footer:[Object(ee.jsx)(k.a,{title:"Delay",children:Object(ee.jsx)(O.a,{type:"primary",onClick:function(){return e.onFutherActionSet(!0)},icon:Object(ee.jsx)(q.a,{})})},"delay"),Object(ee.jsx)(k.a,{title:"Overwrite Sleep",children:Object(ee.jsx)(O.a,{type:"primary",onClick:function(){return e.onFutherActionSet(!1)},icon:Object(ee.jsx)(W.a,{})})},"overwrite_sleep"),Object(ee.jsx)(O.a,{onClick:function(){return e.setState({isFutherActionModalVisible:!1})},children:"Cancel"},"back")],children:Object(ee.jsx)("p",{children:"The appointment submitted can't be concluded during your work and free period, what should the scheduler do to allow for this job to be scheduled?"})})]})}}]),n}(a.a.Component),ie=Object(D.b)((function(e){return{workStart:e.period.workStart,workEnd:e.period.workEnd,freeStart:e.period.freeStart,freeEnd:e.period.freeEnd,appointments:e.appointment.appointments,jobs:e.appointment.jobs}}),(function(e){return{addAppointments:function(t){return e(V(t))},addJob:function(t){return e({type:P,payload:t})}}}))(ne),ae=n(479),oe="SET_WORK_PERIOD",re="SET_FREE_PERIOD",se="WORK_PERIOD",ce="FREE_PERIOD",ue=(n(350),ae.a.RangePicker),de=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var i;return Object(d.a)(this,n),(i=t.call(this,e)).formRef=a.a.createRef(),i.state={isModalVisible:!1},i}return Object(l.a)(n,[{key:"onFormSubmit",value:function(e){switch(this.props.periodType){case se:this.props.setWorkPeriod({start:e.periodRange[0].get("hours"),end:e.periodRange[1].get("hours")});break;case ce:this.props.setFreePeriod({start:e.periodRange[0].get("hours"),end:e.periodRange[1].get("hours")})}this.setState({isModalVisible:!1})}},{key:"getPeriodLabel",value:function(e){switch(e){case ce:return"Free";case se:return"Work"}}},{key:"render",value:function(){var e=this;return Object(ee.jsxs)("div",{children:[Object(ee.jsxs)(O.a,{onClick:function(){return e.setState({isModalVisible:!0})},children:[this.getPeriodLabel(this.props.periodType)," Period"]}),Object(ee.jsx)(v.a,{title:"".concat(this.getPeriodLabel(this.props.periodType)," Period"),visible:this.state.isModalVisible,okText:"Submit",onCancel:function(){return e.setState({isModalVisible:!1})},onOk:function(){e.formRef.current.validateFields().then((function(t){e.onFormSubmit(t)})).catch((function(e){console.log("Validate Failed:",e)}))},children:Object(ee.jsx)(y.a,{ref:this.formRef,name:"periodForm",initialValues:{periodRange:[F()().startOf("day").set("hours",this.props.start),F()().startOf("day").set("hours",this.props.end)],remember:!0},onFinish:function(t){return e.onFormSubmit(t)},children:Object(ee.jsx)(y.a.Item,{name:"periodRange",rules:[{required:!0,message:"The range of the period is required!"}],children:Object(ee.jsx)(ue,{format:"HH:00"})})})})]})}}]),n}(a.a.Component),le=Object(D.b)((function(e,t){switch(t.periodType){case se:return{start:new Number(e.period.workStart),end:new Number(e.period.workEnd)};case ce:return{start:e.period.freeStart,end:e.period.freeEnd};default:return{}}}),(function(e){return{setWorkPeriod:function(t){return e({type:oe,payload:t})},setFreePeriod:function(t){return e({type:re,payload:t})}}}))(de),pe=(n(351),function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){return Object(d.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"onFormSubmit",value:function(){}},{key:"render",value:function(){return Object(ee.jsxs)("header",{children:[Object(ee.jsx)("h2",{children:"Work Scheduler"}),Object(ee.jsxs)("div",{className:"button-group",children:[Object(ee.jsx)(le,{periodType:se}),Object(ee.jsx)(le,{periodType:ce}),Object(ee.jsx)(ie,{})]})]})}}]),n}(a.a.Component)),he=n(491),me=n(119),be=n(159),fe=n(492),je=n(493),Oe=n(494),ve=n(495),ye=(n(352),n(478)),ge=n(477),xe=n(480),Se=n(481),ke=n(113),we=n.n(ke),De=n(184),Ae=n.n(De),Te=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(e){var i;return Object(d.a)(this,n),(i=t.call(this,e)).partitionForm=a.a.createRef(),i.state={currentDay:F()().startOf("week").toDate(),currentViewName:"Day",appointmentUpdateInterval:null,isPartitionModalVisible:!1,partitionAppointmentData:null,partitionHourValue:"",isRealocateModalVisible:!1,realocatedState:{state:"",periods:[],appointment:null,job:null},isAppointmentTooltipVisible:!1,appointmentTooltipMetadata:{target:null,data:{}},shouldShowSleepPeriod:!0,startDayViewHour:0,endDayViewHour:24},i.toggleVisibility=function(){i.setState({isAppointmentTooltipVisible:!i.state.isAppointmentTooltipVisible})},i.onAppointmentMetaChange=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:{},target:null},t=e.data,n=e.target;i.setState({appointmentTooltipMetadata:{data:t,target:n}})},i}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.onUpdateAppointmentsState()}},{key:"componentWillUnmount",value:function(){this.state.appointmentUpdateInterval&&(clearTimeout(this.state.appointmentUpdateInterval),this.setState({appointmentUpdateInterval:null}))}},{key:"onUpdateAppointmentsState",value:function(){var e=this;this.props.appointments.forEach((function(t){var n=e.checkStateOfAppointment(t);t.state!==n&&(console.log("New state"+n+"for appoitnment"+t.id),t.state=n,e.props.updateAppointment(t))}));var t=F()().add(1,"hour").startOf("hour").add(1,"second").diff(F()(),"milliseconds");this.setState({appointmentUpdateInterval:setTimeout((function(){return e.onUpdateAppointmentsState()}),t)})}},{key:"checkStateOfAppointment",value:function(e){if(e.state===R)return R;var t=this.findJobOfAppointment(e);return e.startDate.isAfter(t.dueDate)?H:e.endDate.isBefore(F()())?J:e.startDate.isAfter(F()())?I:_}},{key:"TableTimeCellRenderer",value:function(e){var t=this.props,n=t.workStart,i=t.workEnd,a=t.freeStart,o=t.freeEnd,r=F()(e.startDate),s=F()(e.endDate),c="sleep-period";return this.isHoursBetween(n,i,r,s)?c="work-period":this.isHoursBetween(a,o,r,s)&&(c="free-period"),Object(ee.jsx)(f.e.TimeTableCell,Object(u.a)(Object(u.a)({},e),{},{className:c}))}},{key:"isHoursBetween",value:function(e,t,n,i){var a=n.clone().startOf("day").set("hour",e),o=i.clone().startOf("day").set("hour",t);return n.isBetween(a,o,void 0,"[)")&&i.isBetween(a,o,void 0,"(]")}},{key:"getCustomAppointmentContent",value:function(e){var t=e.data,n=e.formatDate,i=this.findJobOfAppointment(t);return Object(ee.jsx)(f.b.AppointmentContent,Object(u.a)(Object(u.a)({},e),{},{style:{height:"100%"},children:Object(ee.jsxs)("div",{className:"app-appointment-content",children:[Object(ee.jsx)("div",{className:"title",children:i.name}),i.price?Object(ee.jsxs)("div",{className:"value-wrapper",children:["$ ",i.price.toFixed(2)]}):null,Object(ee.jsxs)("span",{children:["Due to: ",i.dueDate.format("DD/MM/YYYY HH:00")]}),Object(ee.jsxs)("div",{className:"hour-wrapper",children:[Object(ee.jsx)("span",{children:n(t.startDate,{hour:"numeric",minute:"numeric"})}),Object(ee.jsx)("span",{style:{padding:"0px 3px"},children:" - "}),Object(ee.jsx)("span",{children:n(t.endDate,{hour:"numeric",minute:"numeric"})})]})]})}))}},{key:"getTooltipContent",value:function(e){var t=this,n=e.appointmentData,i=e.formatDate,a=this.findJobOfAppointment(n);return a?(he.a,Object(ee.jsxs)("div",{className:"tooltip-content",children:[Object(ee.jsxs)(ye.a,{container:!0,alignItems:"flex-start",className:"meta",children:[Object(ee.jsx)(ye.a,{item:!0,xs:2,style:{display:"flex",justifyContent:"center"},children:Object(ee.jsx)(xe.a,{className:"lens",style:{color:n.state===I?"#1890ff":n.state===R?"#a4b1db":n.state===_?"green":n.state===J?"orange":"crimson"}})}),Object(ee.jsxs)(ye.a,{item:!0,xs:10,children:[Object(ee.jsx)("div",{className:"title",children:a.name}),Object(ee.jsx)("div",{children:n.startDate.format("dddd, DD MMMM YYYY")})]})]}),Object(ee.jsxs)(ye.a,{container:!0,alignItems:"center",style:{marginTop:"10px"},children:[Object(ee.jsx)(ye.a,{item:!0,xs:2,style:{display:"flex",justifyContent:"center",color:"gray"},children:Object(ee.jsx)(me.a,{style:{fontSize:"24px"}})}),Object(ee.jsx)(ye.a,{item:!0,xs:10,children:Object(ee.jsx)("div",{children:"".concat(i(n.startDate,{hour:"numeric",minute:"numeric"}),"\n                            - ").concat(i(n.endDate,{hour:"numeric",minute:"numeric"}))})})]}),Object(ee.jsxs)(ye.a,{container:!0,alignItems:"center",children:[Object(ee.jsx)(ye.a,{item:!0,xs:2,style:{display:"flex",justifyContent:"center",color:"gray"},children:Object(ee.jsx)(Se.a,{style:{fontSize:"24px"}})}),Object(ee.jsx)(ye.a,{item:!0,xs:10,children:Object(ee.jsxs)("span",{children:["Due at ",a.dueDate.format("dddd, DD MMMM YYYY HH:00")]})})]}),a.description?Object(ee.jsx)("p",{className:"description",children:a.description}):null,Object(ee.jsxs)("div",{className:"tooltip-wrapper",children:[Object(ee.jsx)(O.a,{disabled:n.state===R,onClick:function(){return t.onCompleteTheAppointment(n)},icon:Object(ee.jsx)(be.a,{}),size:"large",children:"Complete"}),Object(ee.jsx)(O.a,{onClick:function(){return t.onDelayTheAppointment(n)},icon:Object(ee.jsx)(q.a,{}),size:"large",children:"Delay"}),Object(ee.jsx)(O.a,{onClick:function(){return t.onFinishTheAppointment(n)},icon:Object(ee.jsx)(fe.a,{}),size:"large",children:"Finish"})]})]})):null}},{key:"onCompleteTheAppointment",value:function(e){var t=this.props,n=t.appointments,i=t.jobs,a=Object(c.a)(n),o=a.findIndex((function(t){return t.id===e.id}));if(-1!==o){a[o].state=R;var r=i.find((function(t){return t.id===e.jobId}));this.shouldDeleteJob(r,a)?(this.props.deleteJob(r),this.toggleVisibility(),this.onAppointmentMetaChange()):(this.props.updateAppointment(a[o]),this.props.updateJob(this.onUpdateJobStateOnAppointmentChange(r,a)))}else console.error("Unknown appointment was completed!")}},{key:"onUpdateJobStateOnAppointmentChange",value:function(e,t){var n=t.filter((function(t){return e.appointments.includes(t.id)}));return 0===n.filter((function(e){return e.state===I||e.state===_||e.state===H||e.state===J})).length?e.state="JOB_COMPLETED":0===n.filter((function(e){return e.state===R})).length?e.state=L:e.state="JOB_ON_GOING",e}},{key:"shouldDeleteJob",value:function(e,t){return 0===t.filter((function(t){return e.appointments.includes(t.id)})).filter((function(e){return e.state===I||e.state===_||e.state===H||e.state===J})).length}},{key:"onDelayTheAppointment",value:function(e){var t=this.props,n=t.workStart,i=t.workEnd,a=t.freeStart,o=t.freeEnd,r=t.appointments,s=this.findJobOfAppointment(e),c=K(e.hours,s.dueDate,r,[n,i],[a,o],e.endDate);c.state===U||c===Y?(this.setState({realocatedState:Object(u.a)(Object(u.a)({},c),{},{appointment:e,job:s}),isRealocateModalVisible:!0}),this.toggleVisibility(),this.onAppointmentMetaChange()):this.onConfirmationOfRealocation(Object(u.a)(Object(u.a)({},c),{},{appointment:e,job:s}))}},{key:"onConfirmationOfRealocation",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=t||this.state.realocatedState,i=n.periods,a=n.job,o=n.appointment,r=i.map((function(e){return Z(e,a.id)})),s=a.appointments.findIndex((function(e){return e===o.id}));(e=a.appointments).splice.apply(e,[s,1].concat(Object(c.a)(r.map((function(e){return e.id}))))),this.props.updateJob(a),this.props.deleteAppointment([o.id]),this.props.addAppointments(r),this.setState({isRealocateModalVisible:!1,realocatedState:null})}},{key:"onFinishTheAppointment",value:function(e){var t=this.findJobOfAppointment(e);this.props.deleteJob(t),this.toggleVisibility(),this.onAppointmentMetaChange()}},{key:"getAppointmentComponet",value:function(e){var t,n=this,i=e.children,a=e.style,o=e.data;return o.state===R?t="appointment-done":o.state===_?t="appointment-active":o.state===J?t="appointment-late":o.state===H&&(t="appointment-delay"),Object(ee.jsx)(f.b.Appointment,Object(u.a)(Object(u.a)({},e),{},{className:t,style:Object(u.a)({},a),onClick:function(e){for(var t=e.target,i=e.data,a=t;"absolute"!==(a=a.parentElement).style.position;);n.onAppointmentMetaChange({target:a,data:i}),n.toggleVisibility()},children:i}))}},{key:"findJobOfAppointment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?this.props.jobs.findIndex((function(t){return t.id===e.jobId})):this.props.jobs.find((function(t){return t.id===e.jobId}))}},{key:"onAppointmentChangeCommited",value:function(e){var t=this,n=this.props.appointments;if(e.deleted){var i=n.find((function(t){return t.id===e.deleted})),a=this.findJobOfAppointment(i),o=Object(c.a)(n);o.splice(o.findIndex((function(t){return t.id===e.deleted})),1),this.shouldDeleteJob(a,o)?this.props.deleteJob(a):(a.appointments.splice(a.appointments.findIndex((function(t){return t===e.deleted})),1),this.props.deleteAppointment([e.deleted]),this.props.updateJob(a)),this.toggleVisibility(),this.onAppointmentMetaChange()}e.changed&&Object.keys(e.changed).forEach((function(i){var a=e.changed[i],o=a.endDate,r=a.startDate,s=n.find((function(e){return e.id===i})),c=F()(r),u=F()(o);24===u.diff(c,"hours")&&(c.set("hour",t.props.workStart),u=c.clone().set("hour",t.props.workStart+s.hours)),s.startDate=c,s.endDate=u,s.state=t.checkStateOfAppointment(s),t.props.updateAppointment(s)}))}},{key:"onAppointmentPartitionSet",value:function(e){var t,n=this,i=e.hour,a=this.props,o=a.appointments,r=a.deleteAppointment,s=a.updateJob,u=a.addAppointments,d=this.state.partitionAppointmentData,l=o.slice();l.splice(l.findIndex((function(e){return e.id===d.id})),1);var p=this.findJobOfAppointment(d),h=$(d.startDate.get("hour"),d.endDate.get("hour"),d.endDate,l,0,d.startDate,!1,i).map((function(e){return Z(e,p.id)}));p.appointments.splice(p.appointments.findIndex((function(e){return e===d.id})),1),(t=p.appointments).push.apply(t,Object(c.a)(h.map((function(e){return e.id})))),console.log(p),h=h.map((function(e){var t=n.checkStateOfAppointment(e);return e.state!==t&&(e.state=t),e})),console.log(h),r([d.id]),u(h),s(p),this.setState({partitionAppointmentData:null})}},{key:"validateHourInserted",value:function(e,t){if(!t)return Promise.resolve();try{parseInt(t,10)}catch(n){return Promise.reject("The hours value need to be a number!")}return this.state.partitionAppointmentData.hours<=t?Promise.reject("You can't partition an appointment by the same or higher number of hours!"):t<=0?Promise.reject("The number of hour should be non-negative and non-zero!"):Promise.resolve()}},{key:"getToolbarFreeSpaceComponent",value:function(){var e=this;return Object(ee.jsx)(f.i.FlexibleSpace,{className:"toolbar-flexible-space",children:Object(ee.jsx)(Ae.a,{checked:this.state.shouldShowSleepPeriod,onChange:function(t){var n=e.props,i=n.workStart,a=n.workEnd,o=n.freeStart,r=n.freeEnd,s=t.target.checked;e.setState({shouldShowSleepPeriod:s,startDayViewHour:s?0:Math.min(i,o),endDayViewHour:s?24:Math.max(a,r)})},children:"Show Sleep Period"})})}},{key:"getViewSwitcherComponent",value:function(e){var t=this;return Object(ee.jsx)(f.j.Switcher,Object(u.a)(Object(u.a)({},e),{},{onChange:function(e){return t.setState({currentViewName:e})}}))}},{key:"getNavigatorRootComponent",value:function(e){return Object(ee.jsx)(f.d.Root,Object(u.a)({className:"date-navigator-root"},e))}},{key:"getDateNavigatorComponent",value:function(e){var t=this,n="forward"===e.type;return Object(ee.jsxs)("div",{className:"navigation-pair-button-wrapper ".concat(n?"":"reverse"),children:[Object(ee.jsx)("button",{onClick:function(){return t.onNaviagateDate(e.type)},children:n?Object(ee.jsx)(je.a,{}):Object(ee.jsx)(Oe.a,{})}),"Day"===this.state.currentViewName?Object(ee.jsx)("button",{onClick:function(){return t.onNaviagateDate(e.type,!0)},children:"forward"===e.type?Object(ee.jsx)(fe.a,{}):Object(ee.jsx)(ve.a,{})}):null]})}},{key:"onNaviagateDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.state.currentDay;switch(this.state.currentViewName){case"Day":return void this.setState({currentDay:"forward"===e?F()(n).add(t?7:1,"day").toDate():F()(n).subtract(t?7:1,"day").toDate()});case"Month":return void this.setState({currentDay:"forward"===e?F()(n).add(1,"month").toDate():F()(n).subtract(1,"month").toDate()})}}},{key:"getHeaderComponent",value:function(e){var t=this,n=(e.children,e.appointmentData),i=(e.classes,Object(s.a)(e,["children","appointmentData","classes"]));return Object(ee.jsx)(f.a.Header,Object(u.a)(Object(u.a)({},i),{},{appointmentData:n,children:Object(ee.jsx)(ge.a,{className:"icon-button-wrapper",onClick:function(){t.setState({isPartitionModalVisible:!0,partitionAppointmentData:n}),t.toggleVisibility(),t.onAppointmentMetaChange()},children:Object(ee.jsx)(he.a,{})})}))}},{key:"render",value:function(){var e=this;return Object(ee.jsxs)("div",{id:"home-wrapper",children:[Object(ee.jsx)(pe,{}),Object(ee.jsx)(m.a,{children:Object(ee.jsxs)(f.h,{locale:"en-UK",data:this.props.appointments,children:[Object(ee.jsx)(b.s,{currentDate:this.state.currentDay,currentViewName:this.state.currentViewName}),Object(ee.jsx)(b.k,{onCommitChanges:this.onAppointmentChangeCommited.bind(this)}),Object(ee.jsx)(b.m,{}),Object(ee.jsx)(f.c,{}),Object(ee.jsx)(f.e,{displayName:"Week",cellDuration:60,intervalCount:7,startDayHour:this.state.startDayViewHour,endDayHour:this.state.endDayViewHour,timeTableCellComponent:this.TableTimeCellRenderer.bind(this)}),Object(ee.jsx)(f.g,{}),Object(ee.jsx)(f.i,{flexibleSpaceComponent:this.getToolbarFreeSpaceComponent.bind(this)}),Object(ee.jsx)(f.j,{switcherComponent:this.getViewSwitcherComponent.bind(this)}),Object(ee.jsx)(f.d,{rootComponent:this.getNavigatorRootComponent.bind(this),navigationButtonComponent:this.getDateNavigatorComponent.bind(this)}),Object(ee.jsx)(f.b,{appointmentComponent:this.getAppointmentComponet.bind(this),appointmentContentComponent:this.getCustomAppointmentContent.bind(this)}),Object(ee.jsx)(f.a,{showCloseButton:!0,showDeleteButton:!0,headerComponent:this.getHeaderComponent.bind(this),visible:this.state.isAppointmentTooltipVisible,appointmentMeta:this.state.appointmentTooltipMetadata,onAppointmentMetaChange:this.onAppointmentMetaChange,onVisibilityChange:function(){return e.setState({isAppointmentTooltipVisible:!1})},contentComponent:this.getTooltipContent.bind(this)}),Object(ee.jsx)(f.f,{allowResize:function(){return!1}})]})}),this.state.realocatedState?Object(ee.jsx)(we.a,{visible:this.state.isRealocateModalVisible,onOk:function(){return e.onConfirmationOfRealocation()},onCancel:function(){return e.setState({isRealocateModalVisible:!1,realocatedState:null})},children:Object(ee.jsx)("p",{style:{marginTop:"20px"},children:this.state.realocatedState.state===U?"The appointment submitted can't be concluded during your work period,\n                                        do you want to allocate your free time for this appointment?":"The appointment submitted can't be concluded during your work or free time,\n                                        should the scheduler ignore your sleep period and allocate time in it?"})}):null,this.state.isPartitionModalVisible?Object(ee.jsxs)(we.a,{visible:this.state.isPartitionModalVisible,onOk:function(){e.partitionForm.current.validateFields().then((function(t){e.onAppointmentPartitionSet(t),e.setState({isPartitionModalVisible:!1})})).catch((function(t){console.log("Validate Failed:",t),e.setState({isPartitionModalVisible:!1})}))},onCancel:function(){return e.setState({isPartitionModalVisible:!1})},className:"hour-splitter-modal",children:[Object(ee.jsx)("h2",{children:"Appointment Partition Tool"}),Object(ee.jsx)("p",{children:"Input the number of maximum number of hours that each partition of this appointment should have, the Scheduler will divide the appointment by the hour inputted "}),Object(ee.jsx)(y.a,{ref:this.partitionForm,name:"partitionForm",children:Object(ee.jsx)(y.a.Item,{name:"hour",rules:[{required:!0,message:"You need to input a number of hours!"},{validator:this.validateHourInserted.bind(this)}],children:Object(ee.jsx)(g.a,{placeholder:"XX",type:"number",prefix:Object(ee.jsx)(q.a,{}),suffix:"Hours"})})})]}):null]})}}]),n}(a.a.Component),Ce=Object(D.b)((function(e){return{workStart:e.period.workStart,workEnd:e.period.workEnd,freeStart:e.period.freeStart,freeEnd:e.period.freeEnd,appointments:e.appointment.appointments,jobs:e.appointment.jobs}}),(function(e){return{addAppointments:function(t){return e(V(t))},updateAppointment:function(t){return e({type:T,payload:t})},deleteAppointment:function(t){return e({type:C,payload:t})},updateJob:function(t){return e({type:E,payload:t})},deleteJob:function(t){return e({type:M,payload:t})}}}))(Te);var Pe=function(){return Object(ee.jsx)(Ce,{})},Ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,498)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),i(e),a(e),o(e),r(e)}))},Me=(n(420),n(421),n(71)),Ve=n(155),Ne=n(251),Fe=n.n(Ne);function Ie(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=e.findIndex((function(e){return e.id===t.id}));if(-1===n)return console.error("The update operation on appointments failed, no appointment with id "+t.id+" found"),e;var i=Object(c.a)(e);return i[n]=t,i}function Re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=e.findIndex((function(e){return e.id===t.id}));if(-1===n)return console.error("The update operation on jobs failed, no job with id "+t.id+" found"),e;var i=Object(c.a)(e);return i[n]=t,i}function _e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t.map((function(t){return e.findIndex((function(e){return e.id===t}))})),i=Object(c.a)(e);return n.forEach((function(e){return i.splice(e,1)})),i}function Je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=t.findIndex((function(t){return t.id===e.id})),a=Object(c.a)(t);a.splice(i,1);var o=Object(c.a)(n);return e.appointments.forEach((function(e){var t=o.findIndex((function(t){return t.id===e}));o.splice(t,1)})),{jobs:a,appointments:o}}var He={appointments:[],jobs:[],history:[]},Be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:return Object(u.a)(Object(u.a)({},e),{},{appointments:[].concat(Object(c.a)(e.appointments),Object(c.a)(t.payload))});case T:return Object(u.a)(Object(u.a)({},e),{},{appointments:Ie(e.appointments,t.payload)});case C:return Object(u.a)(Object(u.a)({},e),{},{appointments:_e(e.appointments,t.payload)});case P:return Object(u.a)(Object(u.a)({},e),{},{jobs:[].concat(Object(c.a)(e.jobs),[t.payload])});case E:return Object(u.a)(Object(u.a)({},e),{},{jobs:Re(e.jobs,t.payload)});case M:var n=Je(t.payload,e.jobs,e.appointments),i=n.jobs,a=n.appointments;return Object(u.a)(Object(u.a)({},e),{},{jobs:i,appointments:a});default:return e}},Ue=n(137),Ye=function(e,t){return t instanceof F.a?t.toISOString():t},Le=function(e,t){return"string"===typeof t&&t.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?F()(t):t},qe={workStart:null,workEnd:null,freeStart:null,freeEnd:null},We=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oe:return Object(u.a)(Object(u.a)({},e),{},{workStart:t.payload.start,workEnd:t.payload.end});case re:return Object(u.a)(Object(u.a)({},e),{},{freeStart:t.payload.start,freeEnd:t.payload.end});default:return e}},ze={key:"root",storage:Fe.a,transforms:[Object(Ue.a)((function(e){return JSON.stringify(e,Ye)}),(function(e){return JSON.parse(e,Le)}))]},Ke=Object(Me.c)({period:We,appointment:Be}),$e=Object(Ve.a)(ze,Ke);n(424);var Ge=Object(Me.d)($e,Me.a.apply(void 0,[])),Xe=Object(Ve.b)(Ge),Qe=n(252);r.a.render(Object(ee.jsx)(a.a.StrictMode,{children:Object(ee.jsx)(D.a,{store:Ge,children:Object(ee.jsx)(Qe.a,{persistor:Xe,children:Object(ee.jsx)(Pe,{})})})}),document.getElementById("root")),Ee()}},[[425,1,2]]]);
//# sourceMappingURL=main.217c6ca7.chunk.js.map