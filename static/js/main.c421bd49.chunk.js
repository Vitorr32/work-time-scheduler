(this["webpackJsonpwork-time-scheduler"]=this["webpackJsonpwork-time-scheduler"]||[]).push([[0],{228:function(e,t,n){},234:function(e,t,n){},305:function(e,t,n){},306:function(e,t,n){},307:function(e,t,n){},309:function(e,t,n){},312:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(21),a=n.n(o),s=(n.p,n(228),n(32)),c=n(79),p=n(80),d=n(85),u=n(84),l=n(361),h=n(36),b=n(61),j=n(60),m=n(104),f=n(76),O=n(366),v=n(363),y=n(365),x=n(367),k=n(166),w=n(83),S="ADD_APPOINTMENTS",g="UPDATED_APPOINTMENT",E="ADD_JOB",T="UPDATE_JOB",D=n(11),A=n.n(D),C=(n(234),"APPOINTMENT_STATE_NOT_STARTED"),P="APPOINTMENT_STATE_COMPLETED",F="SCHEDULE_WORK_ONLY",M="SCHEDULE_FREE_TIME",R="SCHEDULE_FULL",N=n(368),I=n(369);function _(e,t,n,r,i){var o=Object(m.a)(r,2),a=o[0],s=o[1],c=Object(m.a)(i,2),p=c[0],d=c[1];if(a&&s){var u=V(a,s,t,n,e),l=H(u);if(0!=u.length&&l>=e)return{state:F,periods:u};if(p&&d){var h=V(p,d,t,n,e-l),b=H(h),f=B([].concat(Object(j.a)(u),Object(j.a)(h)));return 0!=h.length&&l+b>=e?{state:M,periods:f}:{state:R,periods:f}}console.error("It was nescessary to use free time, but there was no free period start or end configured!")}else console.error("There was no work period start or end configured!")}function V(e,t,n,r,i,o){for(var a=[],s=o||A()().add(1,"day").startOf("day").set("hour",e),c={start:null,end:null,hours:0};s.isBefore(n);){if(0!=i)if(c.start){if(H([].concat(a,[{hours:1+c.hours}]))>=i){c.end=s.clone(),c.hours++,a.push(Object.assign({},c)),c={start:null,end:null,hours:0};break}}else if(H(a)>=i)break;var p=r.find((function(e){return!!s.isBetween(e.startDate,e.endDate,void 0,"[)")}));if(p)c.start&&(c.end=s.clone(),c.hours++,a.push(Object.assign({},c)),c={start:null,end:null,hours:0}),s=p.endDate.isSameOrAfter(p.endDate.clone().startOf("day").set("hour",t))?s.add(1,"day").set("hour",e):s.set("hour",p.endDate.get("hour"));else{if(s.isSameOrAfter(n)){c.start&&(c.end=s.clone(),c.hours++,a.push(Object.assign({},c)));break}s.isSameOrAfter(s.clone().set("hour",t))?(c.start&&(c.end=s.clone(),c.hours++,a.push(Object.assign({},c)),c={start:null,end:null,hours:0}),s=s.add(1,"day").set("hour",e)):(c.start?(c.end=s.clone(),c.hours++):c.start=s.clone(),s=s.add(1,"hour"))}}return a}function B(e){var t=[],n=[];return e.forEach((function(r,i){if(!n.includes(i)){var o=e.findIndex((function(e){return r.end.isSame(e.start)}));-1!==o&&(n.push(o),r.end=e[o].end,r.hours=r.end.diff(r.start,"hours")),t.push(r)}})),t}function H(e){return e.reduce((function(e,t){return{hours:e.hours+t.hours}}),{hours:0}).hours}var L=n(371),J=n(14),q={labelCol:{span:8},wrapperCol:{span:16}},U=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).formRef=i.a.createRef(),r.state={isModalVisible:!1,isFutherActionModalVisible:!1,appointmentPreview:null,appointmentPeriods:[],appointmentSuccessful:!1},r}return Object(p.a)(n,[{key:"onFormSubmit",value:function(e){var t=this.props.jobs.length,n=this.state.appointmentPeriods.map((function(n,r){return{startDate:n.start,endDate:n.end,title:e.name,price:e.price,description:e.description,state:C,hours:n.hours,id:"job_"+t+"app_"+r,jobId:t}})),r={id:t,name:e.name,appointments:n,price:e.price,description:e.description,dueDate:e.dueDate,totalHours:e.hours};this.props.addJob(r),this.props.addAppointments(n)}},{key:"previewPeriods",value:function(e,t){var n=Object(m.a)(e,1)[0],r=Object(m.a)(t,5),i=(r[0],r[1],r[2],r[3]),o=r[4],a=this.props,s=a.appointments,c=a.workStart,p=a.workEnd,d=a.freeStart,u=a.freeEnd;if(n.name.includes("hours")||n.name.includes("dueDate"))if(i.value&&o.value){var l=_(i.value,o.value,s,[c,p],[d,u]);if(!l)return void console.error("Error on saving the periods");switch(l.state){case F:this.setState({appointmentPreview:"The job can be sucessfully distributed in the work period",appointmentPeriods:l.periods,appointmentSuccessful:!0});break;case M:this.setState({appointmentPreview:"The job will invade some of your free time period",appointmentPeriods:l.periods,appointmentSuccessful:!0});break;case R:this.setState({appointmentPreview:"The job could not be distributed into your work/free time, further action will be required on submit",appointmentPeriods:l.periods,appointmentSuccessful:!1})}}else this.setState({appointmentPreview:"",appointmentPeriods:[]})}},{key:"onFutherActionSet",value:function(e){var t=this,n=this.props,r=n.appointments,i=n.workStart,o=n.workEnd,a=n.freeStart,s=n.freeEnd,c=this.formRef.current.getFieldsValue(),p=c.dueDate,d=c.hours,u=B(V(e?Math.min(i,a):Math.max(o,s),e?Math.max(o,s):Math.min(i,a),e?p.set("year",9999):p,[].concat(Object(j.a)(r),Object(j.a)(this.state.appointmentPeriods)),d-H(this.state.appointmentPeriods),e?p:A()().startOf("day").set("hour",Math.max(o,s))),this.state.appointmentPeriods);this.setState({appointmentPeriods:u,appointmentSuccessful:!0,appointmentPreview:"",isModalVisible:!1,isFutherActionModalVisible:!1},(function(){return t.onFormSubmit(t.formRef.current.getFieldsValue())}))}},{key:"validateDueDate",value:function(e,t){return A()().isSameOrAfter(t)?Promise.reject("The due date needs to be after now!"):Promise.resolve()}},{key:"render",value:function(){var e=this;return Object(J.jsxs)(i.a.Fragment,{children:[Object(J.jsx)(f.a,{type:"primary",onClick:function(){return e.setState({isModalVisible:!0})},children:"Add Event"}),Object(J.jsx)(O.a,{title:"Add Event",visible:this.state.isModalVisible,okText:"Submit",onCancel:function(){return e.setState({isModalVisible:!1})},onOk:function(){e.formRef.current.validateFields().then((function(t){e.state.appointmentSuccessful?(e.onFormSubmit(t),e.setState({isModalVisible:!1})):e.setState({isFutherActionModalVisible:!0})})).catch((function(e){console.log("Validate Failed:",e)}))},children:Object(J.jsxs)(v.a,Object(s.a)(Object(s.a)({},q),{},{ref:this.formRef,name:"eventForm",initialValues:{remember:!0},onFinish:function(t){return e.onFormSubmit(t)},onFieldsChange:this.previewPeriods.bind(this),children:[Object(J.jsx)(v.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"The event name is required"}],children:Object(J.jsx)(y.a,{})}),Object(J.jsx)(v.a.Item,{label:"Description",name:"description",children:Object(J.jsx)(y.a.TextArea,{})}),Object(J.jsx)(v.a.Item,{label:"Price",name:"price",children:Object(J.jsx)(x.a,{formatter:function(e){return"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\$\s?|(,*)/g,"")},min:0,precision:2})}),Object(J.jsx)(v.a.Item,{label:"Estimated Hours",name:"hours",rules:[{required:!0,message:"The ETA is required to allow the scheduler to distribute time"}],children:Object(J.jsx)(x.a,{min:0})}),Object(J.jsx)(v.a.Item,{label:"Due Date",name:"dueDate",rules:[{required:!0,message:"The dude date is required"},{validator:this.validateDueDate}],children:Object(J.jsx)(k.a,{format:"DD/MM/YYYY HH:00",showTime:!0})}),Object(J.jsx)("span",{className:"message",children:this.state.appointmentPreview})]}))}),Object(J.jsx)(O.a,{visible:this.state.isFutherActionModalVisible,footer:[Object(J.jsx)(L.a,{title:"Delay",children:Object(J.jsx)(f.a,{type:"primary",onClick:function(){return e.onFutherActionSet(!0)},icon:Object(J.jsx)(N.a,{})})},"delay"),Object(J.jsx)(L.a,{title:"Overwrite Sleep",children:Object(J.jsx)(f.a,{type:"primary",onClick:function(){return e.onFutherActionSet(!1)},icon:Object(J.jsx)(I.a,{})})},"overwrite_sleep"),Object(J.jsx)(f.a,{onClick:function(){return e.setState({isFutherActionModalVisible:!1})},children:"Cancel"},"back")],children:Object(J.jsx)("p",{children:"The appointment submitted can't be concluded during your work and free period, what should the scheduler do to allow for this job to be scheduled?"})})]})}}]),n}(i.a.Component),W=Object(w.b)((function(e){return{workStart:e.period.workStart,workEnd:e.period.workEnd,freeStart:e.period.freeStart,freeEnd:e.period.freeEnd,appointments:e.appointment.appointments,jobs:e.appointment.jobs}}),(function(e){return{addAppointments:function(t){return e({type:S,payload:t})},addJob:function(t){return e({type:E,payload:t})}}}))(U),Y=n(362),K="SET_WORK_PERIOD",z="SET_FREE_PERIOD",$="WORK_PERIOD",G="FREE_PERIOD",Q=(n(305),Y.a.RangePicker),X=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).formRef=i.a.createRef(),r.state={isModalVisible:!1},r}return Object(p.a)(n,[{key:"onFormSubmit",value:function(e){switch(this.props.periodType){case $:this.props.setWorkPeriod({start:e.periodRange[0].get("hours"),end:e.periodRange[1].get("hours")});break;case G:this.props.setFreePeriod({start:e.periodRange[0].get("hours"),end:e.periodRange[1].get("hours")})}}},{key:"getPeriodLabel",value:function(e){switch(e){case G:return"Free";case $:return"Work"}}},{key:"render",value:function(){var e=this;return Object(J.jsxs)("div",{children:[Object(J.jsxs)(f.a,{onClick:function(){return e.setState({isModalVisible:!0})},children:[this.getPeriodLabel(this.props.periodType)," Period"]}),Object(J.jsx)(O.a,{title:"".concat(this.getPeriodLabel(this.props.periodType)," Period"),visible:this.state.isModalVisible,okText:"Submit",onCancel:function(){return e.setState({isModalVisible:!1})},onOk:function(){e.formRef.current.validateFields().then((function(t){e.onFormSubmit(t)})).catch((function(e){console.log("Validate Failed:",e)}))},children:Object(J.jsx)(v.a,{ref:this.formRef,name:"periodForm",initialValues:{periodRange:[A()().startOf("day").set("hours",this.props.start),A()().startOf("day").set("hours",this.props.end)],remember:!0},onFinish:function(t){return e.onFormSubmit(t)},children:Object(J.jsx)(v.a.Item,{name:"periodRange",rules:[{required:!0,message:"The range of the period is required!"}],children:Object(J.jsx)(Q,{format:"HH:00"})})})})]})}}]),n}(i.a.Component),Z=Object(w.b)((function(e,t){switch(t.periodType){case $:return{start:new Number(e.period.workStart),end:new Number(e.period.workEnd)};case G:return{start:e.period.freeStart,end:e.period.freeEnd};default:return{}}}),(function(e){return{setWorkPeriod:function(t){return e({type:K,payload:t})},setFreePeriod:function(t){return e({type:z,payload:t})}}}))(X),ee=(n(306),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(p.a)(n,[{key:"onFormSubmit",value:function(){}},{key:"render",value:function(){return Object(J.jsxs)("header",{children:[Object(J.jsx)("h2",{children:"Work Scheduler"}),Object(J.jsxs)("div",{className:"button-group",children:[Object(J.jsx)(Z,{periodType:$}),Object(J.jsx)(Z,{periodType:G}),Object(J.jsx)(W,{})]})]})}}]),n}(i.a.Component)),te=(n(307),n(144)),ne=n(370),re=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(p.a)(n,[{key:"TableTimeCellRenderer",value:function(e){var t=this.props,n=t.workStart,r=t.workEnd,i=t.freeStart,o=t.freeEnd,a=A()(e.startDate),c=A()(e.endDate),p="sleep-period";return this.isHoursBetween(n,r,a,c)?p="work-period":this.isHoursBetween(i,o,a,c)&&(p="free-period"),Object(J.jsx)(b.c.TimeTableCell,Object(s.a)(Object(s.a)({},e),{},{className:p}))}},{key:"isHoursBetween",value:function(e,t,n,r){var i=n.clone().startOf("day").set("hour",e),o=r.clone().startOf("day").set("hour",t);return n.isBetween(i,o,void 0,"[)")&&r.isBetween(i,o,void 0,"(]")}},{key:"getCustomAppointmentContent",value:function(e){var t=e.data,n=e.formatDate;return Object(J.jsx)(b.b.AppointmentContent,Object(s.a)(Object(s.a)({},e),{},{style:{height:"100%"},children:Object(J.jsxs)("div",{className:"app-appointment-content",children:[Object(J.jsx)("div",{className:"title",children:t.title}),Object(J.jsxs)("div",{className:"value-wrapper",children:["$ ",t.price]}),Object(J.jsxs)("div",{className:"hour-wrapper",children:[Object(J.jsx)("span",{children:n(t.startDate,{hour:"numeric",minute:"numeric"})}),Object(J.jsx)("span",{style:{padding:"0px 3px"},children:" - "}),Object(J.jsx)("span",{children:n(t.endDate,{hour:"numeric",minute:"numeric"})})]}),t.description?Object(J.jsx)("div",{className:"description",children:t.description}):null]})}))}},{key:"getTooltipContent",value:function(e){var t=this;return Object(J.jsx)(b.a.Content,Object(s.a)(Object(s.a)({},e),{},{children:Object(J.jsxs)("div",{className:"tooltip-wrapper",children:[Object(J.jsx)(f.a,{onClick:function(){return t.onCompleteTheAppointment(e.appointmentData)},icon:Object(J.jsx)(te.a,{}),size:"large",children:"Complete"}),Object(J.jsx)(f.a,{onClick:function(){return t.onDelayTheAppointment(e.appointmentData)},icon:Object(J.jsx)(N.a,{}),size:"large",children:"Delay"}),Object(J.jsx)(f.a,{icon:Object(J.jsx)(ne.a,{}),size:"large",children:"Finish"})]})}))}},{key:"onCompleteTheAppointment",value:function(e){var t=this.props.appointments.findIndex((function(t){return t===e}));if(-1!==t){var n=this.findJobOfAppointment(this.props.appointments[t],!0),r=Object.assign({},this.props.appointments[t]);r.state=P,this.props.updateAppointment({appointment:r,index:t}),this.props.updateJob({job:this.onUpdateAppointmentOnJob(this.props.jobs[n],r),index:n})}else console.error("Unknown appointment was completed!")}},{key:"onUpdateAppointmentOnJob",value:function(e,t){var n=e.appointments.findIndex((function(e){return e.id===t.id}));return e.appointments[n]=t,e}},{key:"onDelayTheAppointment",value:function(e){var t=this.props,n=t.workStart,r=t.workEnd,i=t.freeStart,o=t.freeEnd,a=t.appointments,s=t.jobs,c=this.findJobOfAppointment(e,!0);_(e.hours,A()().startOf("day").set("year",9999),a,[n,r],[i,o],s[c].dueDate)}},{key:"getAppointmentComponet",value:function(e){var t,n=e.children,r=e.style,i=e.data;return this.isAppointmentDone(i)?t="appointment-done":this.isAppointmentNow(i)?t="appointment-active":this.isAppointmentLate(i)&&(t="appointment-late"),Object(J.jsx)(b.b.Appointment,Object(s.a)(Object(s.a)({},e),{},{className:t,style:Object(s.a)({},r),children:n}))}},{key:"getStartDayHour",value:function(){return this.props.workStart&&this.props.freeStart?Math.min(this.props.workStart,this.props.freeStart):0}},{key:"getEndDayHour",value:function(){return this.props.workEnd&&this.props.freeEnd?Math.max(this.props.workEnd,this.props.freeEnd):24}},{key:"isAppointmentDone",value:function(e){return e.state===P}},{key:"isAppointmentNow",value:function(e){return A()().isSameOrAfter(e.startDate)&&A()().isSameOrBefore(e.endDate)}},{key:"isAppointmentLate",value:function(e){return A()().isAfter(e.endDate)&&e.state===C}},{key:"findJobOfAppointment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?this.props.jobs.findIndex((function(t){return t.id===e.jobId})):this.props.jobs.find((function(t){return t.id===e.jobId}))}},{key:"render",value:function(){return Object(J.jsxs)("div",{id:"home-wrapper",children:[Object(J.jsx)(ee,{}),Object(J.jsx)(l.a,{children:Object(J.jsxs)(b.e,{locale:"en-UK",data:this.props.appointments,children:[Object(J.jsx)(h.q,{defaultCurrentViewName:"Week"}),Object(J.jsx)(b.c,{timeTableCellComponent:this.TableTimeCellRenderer.bind(this)}),Object(J.jsx)(b.h,{timeTableCellComponent:this.TableTimeCellRenderer.bind(this)}),Object(J.jsx)(b.d,{}),Object(J.jsx)(b.b,{appointmentComponent:this.getAppointmentComponet.bind(this),appointmentContentComponent:this.getCustomAppointmentContent}),Object(J.jsx)(b.a,{showCloseButton:!0,contentComponent:this.getTooltipContent.bind(this)}),Object(J.jsx)(b.f,{}),Object(J.jsx)(b.g,{})]})})]})}}]),n}(r.Component),ie=Object(w.b)((function(e){return{workStart:e.period.workStart,workEnd:e.period.workEnd,freeStart:e.period.freeStart,freeEnd:e.period.freeEnd,appointments:e.appointment.appointments,jobs:e.appointment.jobs}}),(function(e){return{updateAppointment:function(t){return e({type:g,payload:t})},updateJob:function(t){return e({type:T,payload:t})}}}))(re);var oe=function(){return Object(J.jsx)(ie,{})},ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,372)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),r(e),i(e),o(e),a(e)}))},se=(n(308),n(309),n(68)),ce=n(140),pe=n(205);function de(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=Object(j.a)(e);return r[n]=t,r}function ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=Object(j.a)(e);return r[n]=t,r}var le={appointments:[],jobs:[]},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return Object(s.a)(Object(s.a)({},e),{},{appointments:[].concat(Object(j.a)(e.appointments),Object(j.a)(t.payload))});case g:return Object(s.a)(Object(s.a)({},e),{},{appointments:de(e.appointments,t.payload.appointment,t.payload.index)});case E:return Object(s.a)(Object(s.a)({},e),{},{jobs:[].concat(Object(j.a)(e.jobs),[t.payload])});case T:return Object(s.a)(Object(s.a)({},e),{},{jobs:ue(e.jobs,t.payload.job,t.payload.index)});default:return e}},be={workStart:9,workEnd:18,freeStart:18,freeEnd:24},je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K:return Object(s.a)(Object(s.a)({},e),{},{workStart:t.payload.start,workEnd:t.payload.end});case z:return Object(s.a)(Object(s.a)({},e),{},{freeStart:t.payload.start,freeEnd:t.payload.end});default:return e}},me={key:"root",storage:n.n(pe).a},fe=Object(se.b)({period:je,appointment:he}),Oe=Object(ce.a)(me,fe);var ve=Object(se.c)(Oe),ye=Object(ce.b)(ve),xe=n(206);a.a.render(Object(J.jsx)(i.a.StrictMode,{children:Object(J.jsx)(w.a,{store:ve,children:Object(J.jsx)(xe.a,{persistor:ye,children:Object(J.jsx)(oe,{})})})}),document.getElementById("root")),ae()}},[[312,1,2]]]);
//# sourceMappingURL=main.c421bd49.chunk.js.map